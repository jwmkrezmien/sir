{% extends 'PwcSirBundle::base.html.twig' %}

{% block contentHeader %}
    <h1>{{ 'form.label.vulnerability._show'|trans }}</h1>

    {% include 'PwcSirBundle::_recordActions.html.twig' with { 'entity': entity, 'edit_route': 'vulnerability_edit', 'delete_route': 'vulnerability_delete', 'delete_form': delete_form } %}
{% endblock contentHeader %}

{% block contentBody %}

    {% include 'PwcSirBundle:Vulnerability:_showEntity.html.twig' with { 'entity': entity } %}

    <p>
        {{  'interface.vulndescription.found'|transchoice(entity.existingdescriptions|length, { '%vulnerability%' : entity.name }) }}

        {% if entity.voiddescriptions|length > 0 %}
            {{  'interface.vulndescription.allow_new'|trans }}
        {% endif %}
    </p>

    <ul class="entity index description">

        {% for vulndescription in entity.existingdescriptions %}
        <li class="detail">
            <span class="attr-label">{{ vulndescription.language.name|trans }}:</span>
            <span class="attr-value">
                <a href="{{ path('description_show', { 'slug' : vulndescription.slug }) }}">{{ vulndescription.name }}</a>
            </span>
            <ul class="actions">
                <li>
                    <a href="{{ path('description_edit', { 'slug': entity.slug }) }}">{{ 'form.general.submit.edit'|trans }}</a>
                </li>
            </ul>
        </li>
        {% endfor %}

        {% for vulndescription in entity.voiddescriptions %}
            <li class="detail">
                <span class="attr-label">{{ vulndescription.language.name|trans }}:</span>
                <ul class="languages attr-value">
                    <li><a href="{{ path('description_new', { 'slug': entity.slug, 'languageSlug' : vulndescription.language.slug }) }}">{{ 'form.label.vulndescription._new'|trans({ '%language%': vulndescription.language.name|trans }) }}</a></li>
                </ul>
            </li>
        {% endfor %}

    </ul>

{% endblock contentBody %}