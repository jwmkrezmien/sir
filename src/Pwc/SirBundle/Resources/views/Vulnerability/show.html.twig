{% extends 'PwcSirBundle::base.html.twig' %}

{% block contentBody %}
<div class="well">

    {% include 'PwcSirBundle:Vulnerability:_showEntity.html.twig' with { 'entity': entity } %}

    <div class="record_actions">
        {% include "PwcSirBundle:Includes:actions.html.twig" with { 'entity': entity, 'historyRoute': path('vulnerability_history', { 'slug': entity.slug }), 'editRoute': path('vulnerability_edit', { 'slug': entity.slug }), 'deleteRoute': path('vulnerability_delete', { 'slug': entity.slug }) } %}
        <a class="pull-right cancel" href="{{ path('vulnerability') }}">{{ 'form.general.back'|trans }}</a>
    </div>

    {% include "PwcSirBundle:Includes:deleteModal.html.twig" with { 'delete_form': delete_form } %}
</div>

<div class="well">
    <p>
        {{  'interface.vulndescription.found'|transchoice(entity.existingdescriptions|length, { '%vulnerability%' : entity.name }) }}

        {% if entity.voiddescriptions|length > 0 %}
            {{  'interface.vulndescription.allow_new'|trans }}
        {% endif %}
    </p>

    <ul class="entity index description">

        {% for vulndescription in entity.existingdescriptions %}
        <li class="detail">
            <span class="attr-label">{{ vulndescription.language.name|trans }}:</span>
            <span class="attr-value">
                <a href="{{ path('description_show', { 'slug' : vulndescription.slug }) }}">{{ vulndescription.name }}</a>
            </span>
            <ul class="actions">
                <li>
                    <a href="{{ path('description_edit', { 'slug': entity.slug }) }}">{{ 'form.general.submit.edit'|trans }}</a>
                </li>
            </ul>
        </li>
        {% endfor %}

        {% for vulndescription in entity.voiddescriptions %}
            <li class="detail">
                <span class="attr-label">{{ vulndescription.language.name|trans }}:</span>
                <ul class="languages attr-value">
                    <li><a href="{{ path('description_new', { 'slug': entity.slug, 'languageSlug' : vulndescription.language.slug }) }}">{{ 'form.label.vulndescription._new'|trans({ '%language%': vulndescription.language.name|trans }) }}</a></li>
                </ul>
            </li>
        {% endfor %}

    </ul>
</div>
{% endblock contentBody %}